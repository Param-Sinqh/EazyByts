{"ast":null,"code":"import Node, { addNodeClass } from '../core/Node.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { nodeImmutable, vec2 } from '../shadernode/ShaderNode.js';\nimport { Vector2, Vector4 } from 'three';\nlet resolution, viewportResult;\nclass ViewportNode extends Node {\n  constructor(scope) {\n    super();\n    this.scope = scope;\n    this.isViewportNode = true;\n  }\n  getNodeType() {\n    if (this.scope === ViewportNode.VIEWPORT) return 'vec4';else if (this.scope === ViewportNode.COORDINATE) return 'vec3';else return 'vec2';\n  }\n  getUpdateType() {\n    let updateType = NodeUpdateType.NONE;\n    if (this.scope === ViewportNode.RESOLUTION || this.scope === ViewportNode.VIEWPORT) {\n      updateType = NodeUpdateType.RENDER;\n    }\n    this.updateType = updateType;\n    return updateType;\n  }\n  update({\n    renderer\n  }) {\n    if (this.scope === ViewportNode.VIEWPORT) {\n      renderer.getViewport(viewportResult);\n    } else {\n      renderer.getDrawingBufferSize(resolution);\n    }\n  }\n  setup( /*builder*/\n  ) {\n    const scope = this.scope;\n    let output = null;\n    if (scope === ViewportNode.RESOLUTION) {\n      output = uniform(resolution || (resolution = new Vector2()));\n    } else if (scope === ViewportNode.VIEWPORT) {\n      output = uniform(viewportResult || (viewportResult = new Vector4()));\n    } else {\n      output = viewportCoordinate.div(viewportResolution);\n      let outX = output.x;\n      let outY = output.y;\n      if (/bottom/i.test(scope)) outY = outY.oneMinus();\n      if (/right/i.test(scope)) outX = outX.oneMinus();\n      output = vec2(outX, outY);\n    }\n    return output;\n  }\n  generate(builder) {\n    if (this.scope === ViewportNode.COORDINATE) {\n      let coord = builder.getFragCoord();\n      if (builder.isFlipY()) {\n        // follow webgpu standards\n\n        const resolution = builder.getNodeProperties(viewportResolution).outputNode.build(builder);\n        coord = `${builder.getType('vec3')}( ${coord}.x, ${resolution}.y - ${coord}.y, ${coord}.z )`;\n      }\n      return coord;\n    }\n    return super.generate(builder);\n  }\n}\nViewportNode.COORDINATE = 'coordinate';\nViewportNode.RESOLUTION = 'resolution';\nViewportNode.VIEWPORT = 'viewport';\nViewportNode.TOP_LEFT = 'topLeft';\nViewportNode.BOTTOM_LEFT = 'bottomLeft';\nViewportNode.TOP_RIGHT = 'topRight';\nViewportNode.BOTTOM_RIGHT = 'bottomRight';\nexport default ViewportNode;\nexport const viewportCoordinate = nodeImmutable(ViewportNode, ViewportNode.COORDINATE);\nexport const viewportResolution = nodeImmutable(ViewportNode, ViewportNode.RESOLUTION);\nexport const viewport = nodeImmutable(ViewportNode, ViewportNode.VIEWPORT);\nexport const viewportTopLeft = nodeImmutable(ViewportNode, ViewportNode.TOP_LEFT);\nexport const viewportBottomLeft = nodeImmutable(ViewportNode, ViewportNode.BOTTOM_LEFT);\nexport const viewportTopRight = nodeImmutable(ViewportNode, ViewportNode.TOP_RIGHT);\nexport const viewportBottomRight = nodeImmutable(ViewportNode, ViewportNode.BOTTOM_RIGHT);\naddNodeClass('ViewportNode', ViewportNode);","map":{"version":3,"names":["Node","addNodeClass","NodeUpdateType","uniform","nodeImmutable","vec2","Vector2","Vector4","resolution","viewportResult","ViewportNode","constructor","scope","isViewportNode","getNodeType","VIEWPORT","COORDINATE","getUpdateType","updateType","NONE","RESOLUTION","RENDER","update","renderer","getViewport","getDrawingBufferSize","setup","output","viewportCoordinate","div","viewportResolution","outX","x","outY","y","test","oneMinus","generate","builder","coord","getFragCoord","isFlipY","getNodeProperties","outputNode","build","getType","TOP_LEFT","BOTTOM_LEFT","TOP_RIGHT","BOTTOM_RIGHT","viewport","viewportTopLeft","viewportBottomLeft","viewportTopRight","viewportBottomRight"],"sources":["D:/dumps/online-learning-platform-main/Frontend/node_modules/three/examples/jsm/nodes/display/ViewportNode.js"],"sourcesContent":["import Node, { addNodeClass } from '../core/Node.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { nodeImmutable, vec2 } from '../shadernode/ShaderNode.js';\n\nimport { Vector2, Vector4 } from 'three';\n\nlet resolution, viewportResult;\n\nclass ViewportNode extends Node {\n\n\tconstructor( scope ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\n\t\tthis.isViewportNode = true;\n\n\t}\n\n\tgetNodeType() {\n\n\t\tif ( this.scope === ViewportNode.VIEWPORT ) return 'vec4';\n\t\telse if ( this.scope === ViewportNode.COORDINATE ) return 'vec3';\n\t\telse return 'vec2';\n\n\t}\n\n\tgetUpdateType() {\n\n\t\tlet updateType = NodeUpdateType.NONE;\n\n\t\tif ( this.scope === ViewportNode.RESOLUTION || this.scope === ViewportNode.VIEWPORT ) {\n\n\t\t\tupdateType = NodeUpdateType.RENDER;\n\n\t\t}\n\n\t\tthis.updateType = updateType;\n\n\t\treturn updateType;\n\n\t}\n\n\tupdate( { renderer } ) {\n\n\t\tif ( this.scope === ViewportNode.VIEWPORT ) {\n\n\t\t\trenderer.getViewport( viewportResult );\n\n\t\t} else {\n\n\t\t\trenderer.getDrawingBufferSize( resolution );\n\n\t\t}\n\n\t}\n\n\tsetup( /*builder*/ ) {\n\n\t\tconst scope = this.scope;\n\n\t\tlet output = null;\n\n\t\tif ( scope === ViewportNode.RESOLUTION ) {\n\n\t\t\toutput = uniform( resolution || ( resolution = new Vector2() ) );\n\n\t\t} else if ( scope === ViewportNode.VIEWPORT ) {\n\n\t\t\toutput = uniform( viewportResult || ( viewportResult = new Vector4() ) );\n\n\t\t} else {\n\n\t\t\toutput = viewportCoordinate.div( viewportResolution );\n\n\t\t\tlet outX = output.x;\n\t\t\tlet outY = output.y;\n\n\t\t\tif ( /bottom/i.test( scope ) ) outY = outY.oneMinus();\n\t\t\tif ( /right/i.test( scope ) ) outX = outX.oneMinus();\n\n\t\t\toutput = vec2( outX, outY );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tif ( this.scope === ViewportNode.COORDINATE ) {\n\n\t\t\tlet coord = builder.getFragCoord();\n\n\t\t\tif ( builder.isFlipY() ) {\n\n\t\t\t\t// follow webgpu standards\n\n\t\t\t\tconst resolution = builder.getNodeProperties( viewportResolution ).outputNode.build( builder );\n\n\t\t\t\tcoord = `${ builder.getType( 'vec3' ) }( ${ coord }.x, ${ resolution }.y - ${ coord }.y, ${ coord }.z )`;\n\n\t\t\t}\n\n\t\t\treturn coord;\n\n\t\t}\n\n\t\treturn super.generate( builder );\n\n\t}\n\n}\n\nViewportNode.COORDINATE = 'coordinate';\nViewportNode.RESOLUTION = 'resolution';\nViewportNode.VIEWPORT = 'viewport';\nViewportNode.TOP_LEFT = 'topLeft';\nViewportNode.BOTTOM_LEFT = 'bottomLeft';\nViewportNode.TOP_RIGHT = 'topRight';\nViewportNode.BOTTOM_RIGHT = 'bottomRight';\n\nexport default ViewportNode;\n\nexport const viewportCoordinate = nodeImmutable( ViewportNode, ViewportNode.COORDINATE );\nexport const viewportResolution = nodeImmutable( ViewportNode, ViewportNode.RESOLUTION );\nexport const viewport = nodeImmutable( ViewportNode, ViewportNode.VIEWPORT );\nexport const viewportTopLeft = nodeImmutable( ViewportNode, ViewportNode.TOP_LEFT );\nexport const viewportBottomLeft = nodeImmutable( ViewportNode, ViewportNode.BOTTOM_LEFT );\nexport const viewportTopRight = nodeImmutable( ViewportNode, ViewportNode.TOP_RIGHT );\nexport const viewportBottomRight = nodeImmutable( ViewportNode, ViewportNode.BOTTOM_RIGHT );\n\naddNodeClass( 'ViewportNode', ViewportNode );\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}