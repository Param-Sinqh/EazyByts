{"ast":null,"code":"import { transformedNormalView } from '../../accessors/NormalNode.js';\nimport { positionViewDirection } from '../../accessors/PositionNode.js';\nimport { sheen, sheenRoughness } from '../../core/PropertyNode.js';\nimport { tslFn, float } from '../../shadernode/ShaderNode.js';\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nconst D_Charlie = tslFn(({\n  roughness,\n  dotNH\n}) => {\n  const alpha = roughness.pow2();\n\n  // Estevez and Kulla 2017, \"Production Friendly Microfacet Sheen BRDF\"\n  const invAlpha = float(1.0).div(alpha);\n  const cos2h = dotNH.pow2();\n  const sin2h = cos2h.oneMinus().max(0.0078125); // 2^(-14/2), so sin2h^2 > 0 in fp16\n\n  return float(2.0).add(invAlpha).mul(sin2h.pow(invAlpha.mul(0.5))).div(2.0 * Math.PI);\n}).setLayout({\n  name: 'D_Charlie',\n  type: 'float',\n  inputs: [{\n    name: 'roughness',\n    type: 'float'\n  }, {\n    name: 'dotNH',\n    type: 'float'\n  }]\n});\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nconst V_Neubelt = tslFn(({\n  dotNV,\n  dotNL\n}) => {\n  // Neubelt and Pettineo 2013, \"Crafting a Next-gen Material Pipeline for The Order: 1886\"\n  return float(1.0).div(float(4.0).mul(dotNL.add(dotNV).sub(dotNL.mul(dotNV))));\n}).setLayout({\n  name: 'V_Neubelt',\n  type: 'float',\n  inputs: [{\n    name: 'dotNV',\n    type: 'float'\n  }, {\n    name: 'dotNL',\n    type: 'float'\n  }]\n});\nconst BRDF_Sheen = tslFn(({\n  lightDirection\n}) => {\n  const halfDir = lightDirection.add(positionViewDirection).normalize();\n  const dotNL = transformedNormalView.dot(lightDirection).clamp();\n  const dotNV = transformedNormalView.dot(positionViewDirection).clamp();\n  const dotNH = transformedNormalView.dot(halfDir).clamp();\n  const D = D_Charlie({\n    roughness: sheenRoughness,\n    dotNH\n  });\n  const V = V_Neubelt({\n    dotNV,\n    dotNL\n  });\n  return sheen.mul(D).mul(V);\n});\nexport default BRDF_Sheen;","map":{"version":3,"names":["transformedNormalView","positionViewDirection","sheen","sheenRoughness","tslFn","float","D_Charlie","roughness","dotNH","alpha","pow2","invAlpha","div","cos2h","sin2h","oneMinus","max","add","mul","pow","Math","PI","setLayout","name","type","inputs","V_Neubelt","dotNV","dotNL","sub","BRDF_Sheen","lightDirection","halfDir","normalize","dot","clamp","D","V"],"sources":["D:/dumps/online-learning-platform-main/Frontend/node_modules/three/examples/jsm/nodes/functions/BSDF/BRDF_Sheen.js"],"sourcesContent":["import { transformedNormalView } from '../../accessors/NormalNode.js';\nimport { positionViewDirection } from '../../accessors/PositionNode.js';\nimport { sheen, sheenRoughness } from '../../core/PropertyNode.js';\nimport { tslFn, float } from '../../shadernode/ShaderNode.js';\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nconst D_Charlie = tslFn( ( { roughness, dotNH } ) => {\n\n\tconst alpha = roughness.pow2();\n\n\t// Estevez and Kulla 2017, \"Production Friendly Microfacet Sheen BRDF\"\n\tconst invAlpha = float( 1.0 ).div( alpha );\n\tconst cos2h = dotNH.pow2();\n\tconst sin2h = cos2h.oneMinus().max( 0.0078125 ); // 2^(-14/2), so sin2h^2 > 0 in fp16\n\n\treturn float( 2.0 ).add( invAlpha ).mul( sin2h.pow( invAlpha.mul( 0.5 ) ) ).div( 2.0 * Math.PI );\n\n} ).setLayout( {\n\tname: 'D_Charlie',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'roughness', type: 'float' },\n\t\t{ name: 'dotNH', type: 'float' }\n\t]\n} );\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nconst V_Neubelt = tslFn( ( { dotNV, dotNL } ) => {\n\n\t// Neubelt and Pettineo 2013, \"Crafting a Next-gen Material Pipeline for The Order: 1886\"\n\treturn float( 1.0 ).div( float( 4.0 ).mul( dotNL.add( dotNV ).sub( dotNL.mul( dotNV ) ) ) );\n\n} ).setLayout( {\n\tname: 'V_Neubelt',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'dotNV', type: 'float' },\n\t\t{ name: 'dotNL', type: 'float' }\n\t]\n} );\n\nconst BRDF_Sheen = tslFn( ( { lightDirection } ) => {\n\n\tconst halfDir = lightDirection.add( positionViewDirection ).normalize();\n\n\tconst dotNL = transformedNormalView.dot( lightDirection ).clamp();\n\tconst dotNV = transformedNormalView.dot( positionViewDirection ).clamp();\n\tconst dotNH = transformedNormalView.dot( halfDir ).clamp();\n\n\tconst D = D_Charlie( { roughness: sheenRoughness, dotNH } );\n\tconst V = V_Neubelt( { dotNV, dotNL } );\n\n\treturn sheen.mul( D ).mul( V );\n\n} );\n\nexport default BRDF_Sheen;\n"],"mappings":"AAAA,SAASA,qBAAqB,QAAQ,+BAA+B;AACrE,SAASC,qBAAqB,QAAQ,iCAAiC;AACvE,SAASC,KAAK,EAAEC,cAAc,QAAQ,4BAA4B;AAClE,SAASC,KAAK,EAAEC,KAAK,QAAQ,gCAAgC;;AAE7D;AACA,MAAMC,SAAS,GAAGF,KAAK,CAAE,CAAE;EAAEG,SAAS;EAAEC;AAAM,CAAC,KAAM;EAEpD,MAAMC,KAAK,GAAGF,SAAS,CAACG,IAAI,CAAC,CAAC;;EAE9B;EACA,MAAMC,QAAQ,GAAGN,KAAK,CAAE,GAAI,CAAC,CAACO,GAAG,CAAEH,KAAM,CAAC;EAC1C,MAAMI,KAAK,GAAGL,KAAK,CAACE,IAAI,CAAC,CAAC;EAC1B,MAAMI,KAAK,GAAGD,KAAK,CAACE,QAAQ,CAAC,CAAC,CAACC,GAAG,CAAE,SAAU,CAAC,CAAC,CAAC;;EAEjD,OAAOX,KAAK,CAAE,GAAI,CAAC,CAACY,GAAG,CAAEN,QAAS,CAAC,CAACO,GAAG,CAAEJ,KAAK,CAACK,GAAG,CAAER,QAAQ,CAACO,GAAG,CAAE,GAAI,CAAE,CAAE,CAAC,CAACN,GAAG,CAAE,GAAG,GAAGQ,IAAI,CAACC,EAAG,CAAC;AAEjG,CAAE,CAAC,CAACC,SAAS,CAAE;EACdC,IAAI,EAAE,WAAW;EACjBC,IAAI,EAAE,OAAO;EACbC,MAAM,EAAE,CACP;IAAEF,IAAI,EAAE,WAAW;IAAEC,IAAI,EAAE;EAAQ,CAAC,EACpC;IAAED,IAAI,EAAE,OAAO;IAAEC,IAAI,EAAE;EAAQ,CAAC;AAElC,CAAE,CAAC;;AAEH;AACA,MAAME,SAAS,GAAGtB,KAAK,CAAE,CAAE;EAAEuB,KAAK;EAAEC;AAAM,CAAC,KAAM;EAEhD;EACA,OAAOvB,KAAK,CAAE,GAAI,CAAC,CAACO,GAAG,CAAEP,KAAK,CAAE,GAAI,CAAC,CAACa,GAAG,CAAEU,KAAK,CAACX,GAAG,CAAEU,KAAM,CAAC,CAACE,GAAG,CAAED,KAAK,CAACV,GAAG,CAAES,KAAM,CAAE,CAAE,CAAE,CAAC;AAE5F,CAAE,CAAC,CAACL,SAAS,CAAE;EACdC,IAAI,EAAE,WAAW;EACjBC,IAAI,EAAE,OAAO;EACbC,MAAM,EAAE,CACP;IAAEF,IAAI,EAAE,OAAO;IAAEC,IAAI,EAAE;EAAQ,CAAC,EAChC;IAAED,IAAI,EAAE,OAAO;IAAEC,IAAI,EAAE;EAAQ,CAAC;AAElC,CAAE,CAAC;AAEH,MAAMM,UAAU,GAAG1B,KAAK,CAAE,CAAE;EAAE2B;AAAe,CAAC,KAAM;EAEnD,MAAMC,OAAO,GAAGD,cAAc,CAACd,GAAG,CAAEhB,qBAAsB,CAAC,CAACgC,SAAS,CAAC,CAAC;EAEvE,MAAML,KAAK,GAAG5B,qBAAqB,CAACkC,GAAG,CAAEH,cAAe,CAAC,CAACI,KAAK,CAAC,CAAC;EACjE,MAAMR,KAAK,GAAG3B,qBAAqB,CAACkC,GAAG,CAAEjC,qBAAsB,CAAC,CAACkC,KAAK,CAAC,CAAC;EACxE,MAAM3B,KAAK,GAAGR,qBAAqB,CAACkC,GAAG,CAAEF,OAAQ,CAAC,CAACG,KAAK,CAAC,CAAC;EAE1D,MAAMC,CAAC,GAAG9B,SAAS,CAAE;IAAEC,SAAS,EAAEJ,cAAc;IAAEK;EAAM,CAAE,CAAC;EAC3D,MAAM6B,CAAC,GAAGX,SAAS,CAAE;IAAEC,KAAK;IAAEC;EAAM,CAAE,CAAC;EAEvC,OAAO1B,KAAK,CAACgB,GAAG,CAAEkB,CAAE,CAAC,CAAClB,GAAG,CAAEmB,CAAE,CAAC;AAE/B,CAAE,CAAC;AAEH,eAAeP,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}