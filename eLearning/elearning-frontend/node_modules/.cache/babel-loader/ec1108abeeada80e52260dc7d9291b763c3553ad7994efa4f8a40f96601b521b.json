{"ast":null,"code":"import LightingModel from '../core/LightingModel.js';\nimport BRDF_Lambert from './BSDF/BRDF_Lambert.js';\nimport { diffuseColor } from '../core/PropertyNode.js';\nimport { normalGeometry } from '../accessors/NormalNode.js';\nimport { tslFn, float, vec2, vec3 } from '../shadernode/ShaderNode.js';\nimport { mix, smoothstep } from '../math/MathNode.js';\nimport { materialReference } from '../accessors/MaterialReferenceNode.js';\nconst getGradientIrradiance = tslFn(({\n  normal,\n  lightDirection,\n  builder\n}) => {\n  // dotNL will be from -1.0 to 1.0\n  const dotNL = normal.dot(lightDirection);\n  const coord = vec2(dotNL.mul(0.5).add(0.5), 0.0);\n  if (builder.material.gradientMap) {\n    const gradientMap = materialReference('gradientMap', 'texture').context({\n      getUV: () => coord\n    });\n    return vec3(gradientMap.r);\n  } else {\n    const fw = coord.fwidth().mul(0.5);\n    return mix(vec3(0.7), vec3(1.0), smoothstep(float(0.7).sub(fw.x), float(0.7).add(fw.x), coord.x));\n  }\n});\nclass ToonLightingModel extends LightingModel {\n  direct({\n    lightDirection,\n    lightColor,\n    reflectedLight\n  }, stack, builder) {\n    const irradiance = getGradientIrradiance({\n      normal: normalGeometry,\n      lightDirection,\n      builder\n    }).mul(lightColor);\n    reflectedLight.directDiffuse.addAssign(irradiance.mul(BRDF_Lambert({\n      diffuseColor: diffuseColor.rgb\n    })));\n  }\n  indirectDiffuse({\n    irradiance,\n    reflectedLight\n  }) {\n    reflectedLight.indirectDiffuse.addAssign(irradiance.mul(BRDF_Lambert({\n      diffuseColor\n    })));\n  }\n}\nexport default ToonLightingModel;","map":{"version":3,"names":["LightingModel","BRDF_Lambert","diffuseColor","normalGeometry","tslFn","float","vec2","vec3","mix","smoothstep","materialReference","getGradientIrradiance","normal","lightDirection","builder","dotNL","dot","coord","mul","add","material","gradientMap","context","getUV","r","fw","fwidth","sub","x","ToonLightingModel","direct","lightColor","reflectedLight","stack","irradiance","directDiffuse","addAssign","rgb","indirectDiffuse"],"sources":["D:/dumps/online-learning-platform-main/Frontend/node_modules/three/examples/jsm/nodes/functions/ToonLightingModel.js"],"sourcesContent":["import LightingModel from '../core/LightingModel.js';\nimport BRDF_Lambert from './BSDF/BRDF_Lambert.js';\nimport { diffuseColor } from '../core/PropertyNode.js';\nimport { normalGeometry } from '../accessors/NormalNode.js';\nimport { tslFn, float, vec2, vec3 } from '../shadernode/ShaderNode.js';\nimport { mix, smoothstep } from '../math/MathNode.js';\nimport { materialReference } from '../accessors/MaterialReferenceNode.js';\n\nconst getGradientIrradiance = tslFn( ( { normal, lightDirection, builder } ) => {\n\n\t// dotNL will be from -1.0 to 1.0\n\tconst dotNL = normal.dot( lightDirection );\n\tconst coord = vec2( dotNL.mul( 0.5 ).add( 0.5 ), 0.0 );\n\n\tif ( builder.material.gradientMap ) {\n\n\t\tconst gradientMap = materialReference( 'gradientMap', 'texture' ).context( { getUV: () => coord } );\n\n\t\treturn vec3( gradientMap.r );\n\n\t} else {\n\n\t\tconst fw = coord.fwidth().mul( 0.5 );\n\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( float( 0.7 ).sub( fw.x ), float( 0.7 ).add( fw.x ), coord.x ) );\n\n\t}\n\n} );\n\nclass ToonLightingModel extends LightingModel {\n\n\tdirect( { lightDirection, lightColor, reflectedLight }, stack, builder ) {\n\n\t\tconst irradiance = getGradientIrradiance( { normal: normalGeometry, lightDirection, builder } ).mul( lightColor );\n\n\t\treflectedLight.directDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor: diffuseColor.rgb } ) ) );\n\n\t}\n\n\tindirectDiffuse( { irradiance, reflectedLight } ) {\n\n\t\treflectedLight.indirectDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor } ) ) );\n\n\t}\n\n}\n\nexport default ToonLightingModel;\n"],"mappings":"AAAA,OAAOA,aAAa,MAAM,0BAA0B;AACpD,OAAOC,YAAY,MAAM,wBAAwB;AACjD,SAASC,YAAY,QAAQ,yBAAyB;AACtD,SAASC,cAAc,QAAQ,4BAA4B;AAC3D,SAASC,KAAK,EAAEC,KAAK,EAAEC,IAAI,EAAEC,IAAI,QAAQ,6BAA6B;AACtE,SAASC,GAAG,EAAEC,UAAU,QAAQ,qBAAqB;AACrD,SAASC,iBAAiB,QAAQ,uCAAuC;AAEzE,MAAMC,qBAAqB,GAAGP,KAAK,CAAE,CAAE;EAAEQ,MAAM;EAAEC,cAAc;EAAEC;AAAQ,CAAC,KAAM;EAE/E;EACA,MAAMC,KAAK,GAAGH,MAAM,CAACI,GAAG,CAAEH,cAAe,CAAC;EAC1C,MAAMI,KAAK,GAAGX,IAAI,CAAES,KAAK,CAACG,GAAG,CAAE,GAAI,CAAC,CAACC,GAAG,CAAE,GAAI,CAAC,EAAE,GAAI,CAAC;EAEtD,IAAKL,OAAO,CAACM,QAAQ,CAACC,WAAW,EAAG;IAEnC,MAAMA,WAAW,GAAGX,iBAAiB,CAAE,aAAa,EAAE,SAAU,CAAC,CAACY,OAAO,CAAE;MAAEC,KAAK,EAAEA,CAAA,KAAMN;IAAM,CAAE,CAAC;IAEnG,OAAOV,IAAI,CAAEc,WAAW,CAACG,CAAE,CAAC;EAE7B,CAAC,MAAM;IAEN,MAAMC,EAAE,GAAGR,KAAK,CAACS,MAAM,CAAC,CAAC,CAACR,GAAG,CAAE,GAAI,CAAC;IAEpC,OAAOV,GAAG,CAAED,IAAI,CAAE,GAAI,CAAC,EAAEA,IAAI,CAAE,GAAI,CAAC,EAAEE,UAAU,CAAEJ,KAAK,CAAE,GAAI,CAAC,CAACsB,GAAG,CAAEF,EAAE,CAACG,CAAE,CAAC,EAAEvB,KAAK,CAAE,GAAI,CAAC,CAACc,GAAG,CAAEM,EAAE,CAACG,CAAE,CAAC,EAAEX,KAAK,CAACW,CAAE,CAAE,CAAC;EAElH;AAED,CAAE,CAAC;AAEH,MAAMC,iBAAiB,SAAS7B,aAAa,CAAC;EAE7C8B,MAAMA,CAAE;IAAEjB,cAAc;IAAEkB,UAAU;IAAEC;EAAe,CAAC,EAAEC,KAAK,EAAEnB,OAAO,EAAG;IAExE,MAAMoB,UAAU,GAAGvB,qBAAqB,CAAE;MAAEC,MAAM,EAAET,cAAc;MAAEU,cAAc;MAAEC;IAAQ,CAAE,CAAC,CAACI,GAAG,CAAEa,UAAW,CAAC;IAEjHC,cAAc,CAACG,aAAa,CAACC,SAAS,CAAEF,UAAU,CAAChB,GAAG,CAAEjB,YAAY,CAAE;MAAEC,YAAY,EAAEA,YAAY,CAACmC;IAAI,CAAE,CAAE,CAAE,CAAC;EAE/G;EAEAC,eAAeA,CAAE;IAAEJ,UAAU;IAAEF;EAAe,CAAC,EAAG;IAEjDA,cAAc,CAACM,eAAe,CAACF,SAAS,CAAEF,UAAU,CAAChB,GAAG,CAAEjB,YAAY,CAAE;MAAEC;IAAa,CAAE,CAAE,CAAE,CAAC;EAE/F;AAED;AAEA,eAAe2B,iBAAiB"},"metadata":{},"sourceType":"module","externalDependencies":[]}